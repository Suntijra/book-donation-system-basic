<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign up</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.0.1/mdb.min.css" rel="stylesheet" />

    <!-- Favicon -->
    <link href="img/icon-1.png" rel="icon">
    <style>
         body{
            background-image: url("./img/1.png");
            background-repeat: no-repeat;
            object-fit: cover;
            background-size: cover;
        }
    </style>

</head>

<body>
    <!-- Section: Design Block -->
    <section class="text-center" style="margin-top: 400px;">
        <!-- Background image -->
        <!-- <div class="p-5" style="
          background-image: url('https://mdbootstrap.com/img/new/textures/full/171.jpg');
          height: 300px;
          "></div> -->
        <!-- Background image -->

        <div class="card mx-4 mx-md-5 shadow-5-strong" style="
          margin-top: -100px;
          background: hsla(0, 0%, 100%, 0.8);
          backdrop-filter: blur(30px);
          ">
            <div class="card-body py-5 px-md-5">

                <div class="row d-flex justify-content-center">
                    <div class="col-lg-8">
                        <h2 class="fw-bold mb-5">Sign up now</h2>
                        <form>
                            <!-- first name / last name -->
                            <div class="row">
                                <div class="col-md-6 mb-4">
                                    <div class="form-outline">
                                        <input type="text" id="fname" class="form-control" />
                                        <label class="form-label" for="form3Example1">First name</label>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-4">
                                    <div class="form-outline">
                                        <input type="text" id="lname" class="form-control" />
                                        <label class="form-label" for="form3Example2">Last name</label>
                                    </div>
                                </div>
                            </div>

                            <!-- email / phone / line id -->
                            <div class="row">
                                <div class="col-md-4 mb-4">
                                    <div class="form-outline">
                                        <input type="email" id="email" class="form-control" />
                                        <label class="form-label" for="form3Example1">Email</label>
                                    </div>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <div class="form-outline">
                                        <input type="text" id="phone" class="form-control" />
                                        <label class="form-label" for="form3Example2">Phone number</label>
                                    </div>
                                </div>
                                <div class="col-md-4 mb-4">
                                    <div class="form-outline">
                                        <input type="text" id="line_id" class="form-control" />
                                        <label class="form-label" for="form3Example2">Line ID</label>
                                    </div>
                                </div>
                            </div>

                            <!-- Username input -->
                            <div class="form-outline mb-4">
                                <input type="username" id="username" class="form-control" />
                                <label class="form-label" for="form3Example4">Username</label>
                            </div>

                            <!-- Password input -->
                            <div class="form-outline mb-4">
                                <input type="password" id="password" class="form-control" />
                                <label class="form-label" for="form3Example4">Password</label>
                            </div>

                            <!-- Submit button -->
                            <button onclick="register()" class="btn btn-primary btn-block mb-4">
                                Sign up
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Section: Design Block -->
</body>

</html>
<script src="./js/seturl.js"></script>
<script>
    async function register() {
        event.preventDefault()
        let fname1 = fname.value
        let lname1 = lname.value
        let email1 = email.value
        let phone1 = phone.value
        let line_id1 = line_id.value
        let username1 = username.value
        let password1 = password.value
        if (fname1 && lname1 && email1 && phone1 && line_id1 && username1.length >= 6 && password1.length >= 6) {
            const config_fetch_api = {
                headers: {
                    "Accept": "*/*",
                    "Content-Type": "application/json"
                },
                method: "POST",
                body: JSON.stringify({
                    fname: fname1,
                    lname: lname1,
                    email: email1,
                    phone_number: phone1,
                    line_id: line_id1,
                    username: username1,
                    password: password1
                })
            }
            try {
                let response = await fetch(url_endpoint+'/api/login/register', config_fetch_api)
                let result = await response.json()
                let msg = result.message
                if(msg === 'success'){
                    alert('ไปหน้า login')
                    window.location.href = "./login.html"
                }else{
                    alert('ข้อมูลไม่ถูกต้อง')
                }
            }catch(error){
                alert('err')
            }
           
        } else {
            alert('ข้อมูลไม่ถูกต้อง หรือ รหัสผ่านต้องมากกว่า 6 ตัว หรอเท่ากับ')
        }


    }

</script>